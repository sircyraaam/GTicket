# ========================================
# üîê BLOCK ACCESS TO .ht* FILES
# ========================================
<FilesMatch "^\.ht">
    Require all denied
</FilesMatch>

# ========================================
# üîÄ URL REWRITE ENGINE
# ========================================
Options +FollowSymLinks -MultiViews
RewriteEngine On
RewriteBase /GTicket/

# ========================================
# üîê FORCE HTTPS (proxy-friendly, GoDaddy-safe)
# ========================================
RewriteCond %{HTTPS} off [OR]
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# ========================================
# üßº CLEAN URLS: Redirect /file.php to /file
# ========================================
RewriteCond %{REQUEST_METHOD} !POST
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^.]+)\.php [NC]
RewriteRule ^ %1 [R=302,L,NE]

# ========================================
# üõ† CLEAN URLS: Internally rewrite /file to /file.php
# ========================================
RewriteCond %{REQUEST_FILENAME}.php -f [NC]
RewriteRule ^ %{REQUEST_URI}.php [L]

# ========================================
# üöß CUSTOM 404 ERROR PAGE
# ========================================
ErrorDocument 404 /GTicket/404error.php

# ========================================
# üõ°Ô∏è SECURITY HEADERS
# ========================================
<IfModule mod_headers.c>
    # Prevent XSS and content injection
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self'; style-src 'self'; object-src 'none'; frame-ancestors 'none';"

    # Hide referrer data on cross-origin requests
    Header always set Referrer-Policy "strict-origin-when-cross-origin"

    # Enforce HTTPS in browsers (HSTS)
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

    # Block MIME-type sniffing
    Header always set X-Content-Type-Options "nosniff"

    # Prevent clickjacking
    Header always set X-Frame-Options "SAMEORIGIN"

    # Control resource sharing policy
    Header always set Cross-Origin-Resource-Policy "same-site"
</IfModule>
